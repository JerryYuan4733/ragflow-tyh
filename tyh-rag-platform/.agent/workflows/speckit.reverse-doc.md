---
description: 逆向工程 - 文档生成，整合遍历结果生成结构化功能文档和接口映射。
---

## User Input

```text
$ARGUMENTS
```

You **MUST** consider the user input before proceeding (if not empty).

## 流程概述

本工作流用于逆向工程的**第三阶段：文档生成**，整合遍历结果生成结构化功能文档、接口映射清单和任务计划。

> **核心原则**：所有文档内容必须有可视化素材支撑

### 前置条件

- 已完成 `/speckit.reverse-scan` 和 `/speckit.reverse-traverse`
- 存在完整的层级结构、遍历记录和截图素材

### 步骤

1. **加载上下文**：
   - 读取 `.specify/memory/reverse-engineering-constitution.md`
   - 读取 `docs/reverse/{系统}/hierarchy-structure.md`
   - 读取 `docs/reverse/{系统}/traversal-paths.md`
   - 读取 `docs/reverse/{系统}/api-requests.json`
   - 扫描 `docs/reverse/{系统}/screenshots/` 目录

2. **生成功能操作手册**：
   
   使用模板 `.specify/templates/reverse-feature-manual.md`
   
   对于每个已遍历节点：
   - 提取节点基本信息
   - 关联操作前后截图
   - 描述操作流程（基于截图内容）
   - 写入 `feature-manual.md`

3. **生成接口映射清单**：
   
   使用模板 `.specify/templates/reverse-api-mapping.md`
   
   对于每个捕获的接口：
   - 关联触发操作和节点
   - 记录请求/响应详情
   - 关联操作时的截图
   - 写入 `api-mapping.md`

4. **生成任务计划清单**：
   
   使用模板 `.specify/templates/reverse-task-list.md`
   
   汇总以下任务项：
   - ⚠️ 不可操作节点的跟进任务
   - 需要补充验证的接口
   - 需要进一步探索的功能
   - 写入 `task-list.md`

5. **生成文档索引**：
   
   创建 `index.md`：
   - 基本信息汇总
   - 快速导航链接
   - 节点追溯索引表

6. **完整性校验**：
   - 检查所有节点是否有对应文档记录
   - 检查所有截图是否被引用
   - 检查接口是否完整关联

7. **报告**：输出文档生成统计

## 输出物

| 文件 | 说明 |
|------|------|
| `feature-manual.md` | 功能操作手册 |
| `api-mapping.md` | 接口映射清单 |
| `task-list.md` | 任务计划清单 |
| `index.md` | 文档索引与追溯入口 |

## 功能操作手册格式

```markdown
# {系统名称} - 功能操作手册

## 1. 客户管理

### 1.1 客户维护

#### 1.1.1 客户列表

- **节点标识**: 客户管理-客户维护-客户列表
- **素材编号**: KHGL-KHWH-KHLB-0001 ~ 0005
- **功能说明**: [基于截图描述]

**操作步骤**:
1. 点击导航栏"客户管理"
   ![](./screenshots/KHGL-KHWH-KHLB-0001_before.png)
2. 展开后点击"客户维护" → "客户列表"
   ![](./screenshots/KHGL-KHWH-KHLB-0002_after.png)

**可见操作项**:
| 操作 | 类型 | 说明 | 状态 |
|------|------|------|------|
| 新增 | 按钮 | 新增客户 | ✅ 可用 |
| 编辑 | 按钮 | 编辑选中客户 | ✅ 可用 |
| 删除 | 按钮 | 删除选中客户 | ⚠️ 置灰 |

**关联接口**: API-001, API-002
```

## 接口映射清单格式

```markdown
# {系统名称} - 接口映射清单

## 接口总览

| 编号 | 接口 | 方法 | 触发操作 | 节点标识 |
|------|------|------|----------|----------|
| API-001 | /api/customers | GET | 进入客户列表 | 客户管理-客户维护-客户列表 |
| API-002 | /api/customers | POST | 点击新增保存 | 客户管理-客户维护-新增客户 |

## 接口详情

### API-001: 获取客户列表

| 属性 | 值 |
|------|------|
| URL | `/api/v1/customers` |
| Method | GET |
| 触发操作 | 进入客户列表页面 |
| 节点标识 | 客户管理-客户维护-客户列表 |
| 素材编号 | KHGL-KHWH-KHLB-0002 |

**请求参数**:
```json
{
  "page": 1,
  "pageSize": 20
}
```

**响应示例**:
```json
{
  "code": 0,
  "data": { "list": [], "total": 0 }
}
```
```

## 任务计划清单格式

```markdown
# {系统名称} - 任务计划清单

## 任务统计

| 类型 | 数量 |
|------|------|
| 功能跟进 | X |
| 接口验证 | X |
| 权限申请 | X |

## 任务列表

### TASK-001: 跟进删除客户权限

| 属性 | 值 |
|------|------|
| 类型 | 权限申请 |
| 优先级 | P1 |
| 关联节点 | 客户管理-客户维护-删除客户 |
| 当前状态 | ⚠️ 按钮置灰，权限不足 |
| 素材编号 | KHGL-KHWH-SCKH-0001 |

**执行步骤**:
1. 联系系统管理员申请删除权限
2. 获取权限后重新执行遍历
3. 补充功能文档和接口记录
```

## 文档索引格式

```markdown
# {系统名称} 逆向文档索引

## 基本信息

| 项目 | 值 |
|------|------|
| 系统名称 | {名称} |
| 系统 URL | {URL} |
| 遍历日期 | {日期} |
| 可见节点总数 | {数量} |
| 已遍历节点 | {数量} |
| 覆盖率 | 100% |
| 捕获接口数 | {数量} |
| 截图素材数 | {数量} |

## 快速导航

- [层级结构表](./hierarchy-structure.md)
- [层级图谱](./hierarchy-graph.md)
- [遍历路径](./traversal-paths.md)
- [功能手册](./feature-manual.md)
- [接口映射](./api-mapping.md)
- [任务清单](./task-list.md)

## 节点追溯索引

| 节点标识 | 状态 | 素材范围 | 关联接口 | 文档章节 |
|----------|------|----------|----------|----------|
| 客户管理-客户维护-客户列表 | ✅ | 0001-0005 | API-001,002 | 1.1.1 |
```

## Key Rules

- **素材绑定**：每条记录必须关联截图素材
- **可追溯**：所有内容必须能通过索引追溯到源素材
- **无捏造**：不描述截图中未出现的功能
- **任务闭环**：不可操作节点必须转化为任务项
- 遵循 `reverse-engineering-constitution.md` 规约
